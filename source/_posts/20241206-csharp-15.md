---
title: 'C# 13 ë° .NET 9 í•„ìˆ˜ ê¸°ëŠ¥ ì†Œê°œ'
categories:
  - Programming
  - Language
  - C#
tags:
  - Programming
  - C#
  - .NET
  - ASP.NET Core
  - ë¼ì´ë¸ŒëŸ¬ë¦¬
date: 2024-12-06 14:42:58
thumbnail: /images/thumbnail/csharp.png
---

.NET 9ëŠ” ë§ì€ ë³€í™”ì™€ ê°œì„  ì‚¬í•­ì„ ì œê³µí•˜ë©°, ê³§ ì¶œì‹œë¥¼ ì•ë‘ê³  ìˆìŠµë‹ˆë‹¤. ì´ ê¸€ì—ì„œëŠ” **.NET 9ì™€ C# 13**ì—ì„œ ê°€ì¥ ì˜í–¥ì„ ë§ì´ ë¯¸ì¹˜ê³  ë„ë¦¬ ì ìš© ê°€ëŠ¥í•œ ì£¼ìš” ê¸°ëŠ¥ë“¤ì„ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.

## 1. ìƒˆë¡œìš´ Lock ê°ì²´

C# 13ì—ì„œëŠ” **System.Threading.Lock**ë¼ëŠ” ìƒˆë¡œìš´ íƒ€ì…ì´ ë„ì…ë˜ì–´ ìƒí˜¸ ë°°ì œë¥¼ ì²˜ë¦¬í•©ë‹ˆë‹¤. ê¸°ì¡´ì—ëŠ” `object` íƒ€ì…ì„ ì‚¬ìš©í•´ ì ê¸ˆì„ êµ¬í˜„í–ˆì§€ë§Œ, ì´ì œëŠ” ì „ìš© `Lock` íƒ€ì…ì´ ì œê³µë˜ì–´ ì•ìœ¼ë¡œ ëŒ€ë¶€ë¶„ì˜ ì ê¸ˆ ì‘ì—…ì— í‘œì¤€ìœ¼ë¡œ ìë¦¬ ì¡ì„ ê²ƒìœ¼ë¡œ ê¸°ëŒ€ë©ë‹ˆë‹¤.

```cs
// ê¸°ì¡´ ë°©ì‹ (Before)
public class LockExample
{
    private readonly object _lock = new(); // ì ê¸ˆì„ ìœ„í•œ object ì¸ìŠ¤í„´ìŠ¤ ìƒì„±

    public void DoStuff()
    {
        lock (_lock) // objectë¥¼ ì´ìš©í•œ ì ê¸ˆ
        {
           Console.WriteLine("ê¸°ì¡´ ë°©ì‹ì˜ lock ë¸”ë¡ ì•ˆì…ë‹ˆë‹¤.");
        }
    }
}

// .NET 9 ë°©ì‹
public class LockExample
{
    private readonly Lock _lock = new(); // ìƒˆë¡œìš´ Lock ê°ì²´ ìƒì„±

    public void DoStuff()
    {
        lock (_lock) // Lock ê°ì²´ë¥¼ ì´ìš©í•œ ì ê¸ˆ
        {
            Console.WriteLine(".NET 9 ë°©ì‹ì˜ lock ë¸”ë¡ ì•ˆì…ë‹ˆë‹¤.");
        }
    }
}
```

**ì£¼ìš” ì¥ì **

- **ë” ê¹”ë”í•˜ê³  ì•ˆì „í•œ ì½”ë“œ:** ì½”ë“œê°€ ë”ìš± ì½ê¸° ì‰½ê³  ì˜ˆì¸¡ ê°€ëŠ¥í•´ì§‘ë‹ˆë‹¤. ë˜í•œ, `Lock` ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì¼ë°˜ `object`ë¡œ ì˜ëª» ì‚¬ìš©í•˜ë©´ ì»´íŒŒì¼ëŸ¬ê°€ ê²½ê³ ë¥¼ ì œê³µí•©ë‹ˆë‹¤.
- **ì„±ëŠ¥ í–¥ìƒ:** Microsoftì— ë”°ë¥´ë©´, ì„ì˜ì˜ `object` ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì ê¸ˆì— ì‚¬ìš©í•˜ëŠ” ê²ƒë³´ë‹¤ ë” íš¨ìœ¨ì ì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- **ìƒˆë¡œìš´ ì ê¸ˆ ë©”ì»¤ë‹ˆì¦˜:** `EnterScope`ê°€ ë‚´ë¶€ì ìœ¼ë¡œ `Monitor` í´ë˜ìŠ¤ë¥¼ ëŒ€ì²´í•©ë‹ˆë‹¤. ì´ ë©”ì»¤ë‹ˆì¦˜ì€ `Dispose` íŒ¨í„´ì„ ë”°ë¥´ëŠ” `ref struct`ë¥¼ ë°˜í™˜í•˜ë¯€ë¡œ `using` ë¬¸ê³¼ ë§¤ë„ëŸ½ê²Œ ê²°í•©ë©ë‹ˆë‹¤.
- **ë¹„ë™ê¸° ì‘ì—…ì˜ ì œí•œ:** `lock` ë¸”ë¡ ë‚´ì—ì„œëŠ” ì—¬ì „íˆ `async` í˜¸ì¶œì´ í—ˆìš©ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ì´ëŠ” ì ê¸ˆê³¼ ë¹„ë™ê¸° ì½”ë“œê°€ ìƒí˜¸ ì‘ìš©í•˜ëŠ” ë°©ì‹ì— ë‚´ì¬ëœ í•œê³„ ë•Œë¬¸ì…ë‹ˆë‹¤. ê¸°ì¡´ì˜ `SemaphoreSlim` ì ‘ê·¼ ë°©ì‹ì´ ì—¬ì „íˆ ëŒ€ì•ˆìœ¼ë¡œ ì‚¬ìš©ë©ë‹ˆë‹¤.

```cs
public class LockExample
{
   private readonly Lock _lock = new();
   private readonly SemaphoreSlim _semaphore = new(1, 1);

   public async Task DoStuff(int val)
   {
      // 1. 'lock' êµ¬ë¬¸ê³¼ ë¹„ë™ê¸° ì‘ì—…ì˜ ì œí•œ
      lock(_lock)
      {
         await Task.Delay(1000);
         // ì»´íŒŒì¼ ì˜¤ë¥˜: 'lock' ë¸”ë¡ ë‚´ë¶€ì—ì„œ 'await'ë¥¼ ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.
      }

      // 2. 'EnterScope'ì™€ ë¹„ë™ê¸° ì‘ì—…ì˜ ì œí•œ
      using(_lock.EnterScope())
      {
         await Task.Delay(1000);
         // ëŸ°íƒ€ì„ ì˜¤ë¥˜: 'System.Threading.Lock.Scope' íƒ€ì… ì¸ìŠ¤í„´ìŠ¤ëŠ” 'await' ë˜ëŠ” 'yield' ê²½ê³„ë¥¼ ë„˜ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.
      }

      // 3. SemaphoreSlimì„ ì´ìš©í•œ ë¹„ë™ê¸° ì‘ì—…
      await _semaphore.WaitAsync();
      try
      {
         await Task.Delay(10);
         // ì •ìƒì ìœ¼ë¡œ ë™ì‘: SemaphoreSlimì€ ë¹„ë™ê¸° ì‘ì—…ì„ ì§€ì›í•©ë‹ˆë‹¤.
      }
      finally
      {
         _semaphore.Release(); // ë°˜ë“œì‹œ ìì›ì„ í•´ì œí•´ì•¼ í•¨
      }
   }
}
```

## 2. Task.WhenEach

ë‹¤ì–‘í•œ ì‹œê°„ ê°„ê²©ìœ¼ë¡œ ì™„ë£Œë˜ëŠ” ì‘ì—…(Task) ë¦¬ìŠ¤íŠ¸ê°€ ìˆë‹¤ê³  ê°€ì •í•´ë´…ì‹œë‹¤. ì‘ì—…ì´ ëª¨ë‘ ëë‚  ë•Œê¹Œì§€ ê¸°ë‹¤ë¦¬ëŠ” `WaitAll()` ë°©ì‹ì€ ì´ ê²½ìš° ì í•©í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ê°ê°ì˜ ì‘ì—…ì´ ì™„ë£Œë˜ëŠ” ì¦‰ì‹œ ì²˜ë¦¬í•˜ê³  ì‹¶ë‹¤ë©´ `Task.WaitAny()`ë¥¼ ì‚¬ìš©í•˜ì—¬ ëŒ€ì•ˆì ìœ¼ë¡œ êµ¬í˜„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ C# 13ì—ì„œëŠ” ì´ë¥¼ ë” ìš°ì•„í•˜ê³  íš¨ìœ¨ì ìœ¼ë¡œ ì²˜ë¦¬í•  ìˆ˜ ìˆëŠ” `Task.WhenEach` ê¸°ëŠ¥ì´ ë„ì…ë˜ì—ˆìŠµë‹ˆë‹¤.

```cs
// ëœë¤í•œ ê°„ê²©ìœ¼ë¡œ ì™„ë£Œë˜ëŠ” 5ê°œì˜ ì‘ì—… ë¦¬ìŠ¤íŠ¸ ìƒì„±
var tasks = Enumerable.Range(1, 5)
   .Select(async i =>
   {
     await Task.Delay(new Random().Next(1000, 5000)); // 1~5ì´ˆ ì‚¬ì´ì˜ ë”œë ˆì´
     return $"Task {i} done"; // ì™„ë£Œ ë©”ì‹œì§€ ë°˜í™˜
   })
   .ToList();

// ê¸°ì¡´ ë°©ì‹ (Before)
while(tasks.Count > 0) // ì•„ì§ ì™„ë£Œë˜ì§€ ì•Šì€ ì‘ì—…ì´ ë‚¨ì•„ ìˆëŠ” ë™ì•ˆ
{
   var completedTask = await Task.WhenAny(tasks); // ê°€ì¥ ë¨¼ì € ì™„ë£Œëœ ì‘ì—… ì„ íƒ
   tasks.Remove(completedTask); // ì™„ë£Œëœ ì‘ì—… ë¦¬ìŠ¤íŠ¸ì—ì„œ ì œê±°
   Console.WriteLine(await completedTask); // ì‘ì—… ê²°ê³¼ ì¶œë ¥
}

// .NET 9 ë°©ì‹
await foreach (var completedTask in Task.WhenEach(tasks)) // ì‘ì—…ì´ ì™„ë£Œë  ë•Œë§ˆë‹¤ ì²˜ë¦¬
   Console.WriteLine(await completedTask); // ì‘ì—… ê²°ê³¼ ì¶œë ¥
```

`Task.WhenEach`ëŠ” `IAsyncEnumerable<Task<TResult>>`ë¥¼ ë°˜í™˜í•˜ë©°, `await foreachë¥¼` ì‚¬ìš©í•´ ì‘ì—…ì´ ì™„ë£Œë˜ëŠ” ì¦‰ì‹œ ì‰½ê²Œ ë°˜ë³µ(iterate) ì²˜ë¦¬í•  ìˆ˜ ìˆë„ë¡ í•´ì¤ë‹ˆë‹¤.ğŸ‘Œ

## 3. params Collections

C# 13ë¶€í„° `params` ë§¤ê°œë³€ìˆ˜ë¡œ ì»¬ë ‰ì…˜ í‘œí˜„ì‹ì— ì§€ì›ë˜ëŠ” ëª¨ë“  íƒ€ì…ì„ ì‚¬ìš©í•  ìˆ˜ ìˆê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤.

```cs
// ê¸°ì¡´ ë°©ì‹ (Before)
static void WriteNumbersCount(params int[] numbers)
   => Console.WriteLine(numbers.Length); // int ë°°ì—´ë§Œ í—ˆìš©
```

C# 13 ì´í›„, `params` ë§¤ê°œë³€ìˆ˜ëŠ” ë‹¤ì–‘í•œ ì»¬ë ‰ì…˜ íƒ€ì…ì„ ì§€ì›í•©ë‹ˆë‹¤.

```cs
// .NET 9
// ReadOnlySpan<int> ì‚¬ìš©
static void WriteNumbersCount(params ReadOnlySpan<int> numbers) =>
    Console.WriteLine(numbers.Length);

// IEnumerable<int> ì‚¬ìš©
static void WriteNumbersCount(params IEnumerable<int> numbers) =>
    Console.WriteLine(numbers.Count());

// HashSet<int> ì‚¬ìš©
static void WriteNumbersCount(params HashSet<int> numbers) =>
    Console.WriteLine(numbers.Count);
```

- **ë” ê¹”ë”í•œ ì½”ë“œ:** `.ToArray()`, `.ToList()` í˜¸ì¶œ íšŸìˆ˜ë¥¼ í¬ê²Œ ì¤„ì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- **ì„±ëŠ¥ í–¥ìƒ:** `.ToArray()`, `.ToList()` ê°™ì€ í˜¸ì¶œì€ ìì²´ì ìœ¼ë¡œ ì¶”ê°€ì ì¸ ë¦¬ì†ŒìŠ¤ ì˜¤ë²„í—¤ë“œë¥¼ ë°œìƒì‹œí‚µë‹ˆë‹¤. ì´ì œ `Span<>`ê³¼ `IEnumerable<>`ë¥¼ ì§€ì›í•¨ìœ¼ë¡œì¨ ë” íš¨ìœ¨ì ì¸ ë©”ëª¨ë¦¬ ì‚¬ìš©ê³¼ ì§€ì—° ì‹¤í–‰(lazy execution)ì„ í™œìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê²°ê³¼ì ìœ¼ë¡œ, ìœ ì—°ì„±ê³¼ ì„±ëŠ¥ì´ ìš”êµ¬ë˜ëŠ” ì‹œë‚˜ë¦¬ì˜¤ì—ì„œ ë” ë‚˜ì€ ì„±ëŠ¥ì„ ì œê³µí•©ë‹ˆë‹¤.

## 4. Semi-Auto Properties (ë°˜ìë™ ì†ì„±)

C#ì—ì„œ `public int Number { get; set; }`ì™€ ê°™ì€ ìë™ êµ¬í˜„ ì†ì„±ì„ ì„ ì–¸í•˜ë©´, ì»´íŒŒì¼ëŸ¬ê°€ ìë™ìœ¼ë¡œ ë°±ì—… í•„ë“œ(ì˜ˆ: `_number`)ì™€ ë‚´ë¶€ getter/setter ë©”ì„œë“œ(`void set_Number(int number)`, `int get_Number()`)ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.

í•˜ì§€ë§Œ ì†ì„±ì˜ getterë‚˜ setterì—ì„œ ìœ íš¨ì„± ê²€ì‚¬, ê¸°ë³¸ê°’ ì„¤ì •, ê³„ì‚°, ì§€ì—° ë¡œë”©(lazy loading) ë“±ì˜ ì»¤ìŠ¤í…€ ë¡œì§ì´ í•„ìš”í•  ê²½ìš°, í´ë˜ìŠ¤ì—ì„œ ë°±ì—… í•„ë“œë¥¼ ì§ì ‘ ì •ì˜í•´ì•¼ í–ˆìŠµë‹ˆë‹¤.

C# 13ì—ì„œëŠ” `field` í‚¤ì›Œë“œë¥¼ ë„ì…í•˜ì—¬, ë°±ì—… í•„ë“œë¥¼ ì§ì ‘ ì •ì˜í•˜ì§€ ì•Šê³ ë„ ë°”ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ ê°„ì†Œí™”í–ˆìŠµë‹ˆë‹¤.

```cs
// ê¸°ì¡´ ë°©ì‹
public class MagicNumber
{
    private int _number; // ë°±ì—… í•„ë“œ ì§ì ‘ ì •ì˜

    public int Number
    {
        get => _number * 10; // ì»¤ìŠ¤í…€ ë¡œì§ ì ìš©
        set {
            if (value < 0) // ìœ íš¨ì„± ê²€ì‚¬
                throw new ArgumentOutOfRangeException(nameof(value), "ê°’ì€ 0ë³´ë‹¤ ì»¤ì•¼ í•©ë‹ˆë‹¤.");
            _number = value;
        }
    }
}
```

```cs
// .NET 9 ë°©ì‹
public class MagicNumber
{
    public int Number
    {
        get => field; // ì»´íŒŒì¼ëŸ¬ê°€ ìƒì„±í•œ ë°±ì—… í•„ë“œì— ì§ì ‘ ì ‘ê·¼
        set {
            if (value < 0) // ìœ íš¨ì„± ê²€ì‚¬
                throw new ArgumentOutOfRangeException(nameof(value), "ê°’ì€ 0ë³´ë‹¤ ì»¤ì•¼ í•©ë‹ˆë‹¤.");
            field = value; // field í‚¤ì›Œë“œë¡œ ë°±ì—… í•„ë“œ ì„¤ì •
        }
    }
}
```

- **ë³´ì¼ëŸ¬í”Œë ˆì´íŠ¸ ì½”ë“œ ê°ì†Œ:** ë°±ì—… í•„ë“œë¥¼ ìˆ˜ë™ìœ¼ë¡œ ì •ì˜í•  í•„ìš”ê°€ ì—†ì–´ì ¸ ì½”ë“œê°€ ë” ê¹”ë”í•˜ê³  ê°„ê²°í•´ì§‘ë‹ˆë‹¤.
- **ê°€ë…ì„± í–¥ìƒ:** `field` í‚¤ì›Œë“œë¥¼ í‘œì¤€ìœ¼ë¡œ ì‚¬ìš©í•˜ë©´ì„œ, ì»¤ìŠ¤í…€ ë°±ì—… í•„ë“œ ì´ë¦„ì„ ê´€ë¦¬í•  í•„ìš”ê°€ ì—†ì–´ ì½”ë“œì˜ ëª…í™•ì„±ì´ ë†’ì•„ì§‘ë‹ˆë‹¤.
- **ì†ì„± ë²”ìœ„ ë‚´ í•„ë“œ ì œí•œ:** ë°±ì—… í•„ë“œëŠ” ì†ì„± ë‚´ë¶€ë¡œ ì œí•œë˜ì–´ í´ë˜ìŠ¤ì˜ ë‹¤ë¥¸ ë¶€ë¶„ì—ì„œ ì˜ë„ì¹˜ ì•Šê²Œ ì‚¬ìš©ë˜ëŠ” ì¼ì„ ë°©ì§€í•˜ë©°, ìº¡ìŠí™”ë¥¼ ê°•í™”í•©ë‹ˆë‹¤.
- **ğŸš¨ ì ì¬ì  í˜¸í™˜ì„± ë¬¸ì œ:** í´ë˜ìŠ¤ì— ì´ë¯¸ `field`ë¼ëŠ” ì´ë¦„ì˜ ì†ì„±ì´ ìˆë‹¤ë©´ ìƒˆ í‚¤ì›Œë“œë³´ë‹¤ ìš°ì„  ì ìš©ë˜ì–´ ì˜ˆê¸°ì¹˜ ì•Šì€ ë™ì‘ì´ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ëŠ” ì´ ê¸°ëŠ¥ì´ 2016ë…„ ìµœì´ˆ ì œì•ˆ ì´í›„ ì§€ì—°ëœ ì´ìœ  ì¤‘ í•˜ë‚˜ë¡œ ë³´ì…ë‹ˆë‹¤.

## 5. Hybrid Cache

ìƒˆë¡œìš´ **HybridCache API**ëŠ” ê¸°ì¡´ì˜ `IDistributedCache`ì™€ `IMemoryCache` APIì—ì„œ ë°œìƒí•˜ëŠ” ë¬¸ì œë¥¼ í•´ê²°í•˜ë©°, ìƒˆë¡œìš´ ê¸°ëŠ¥ê³¼ ì„±ëŠ¥ì„ ì œê³µí•´ .NETì—ì„œ ìºì‹±ì„ ë” ìœ ì—°í•˜ê³  íš¨ìœ¨ì ìœ¼ë¡œ ë§Œë“­ë‹ˆë‹¤. íŠ¹íˆ, **ìŠ¤íƒ¬í”¼ë“œ ë¬¸ì œ**ì™€ ê°™ì€ ìºì‹±ì˜ í•œê³„ë¥¼ ê°œì„ í•˜ë©° ëŒ€ë¶€ë¶„ì˜ `IDistributedCache` ë° `IMemoryCache` ì‹œë‚˜ë¦¬ì˜¤ì— ë“œë¡­ì¸(dop-in) ë°©ì‹ìœ¼ë¡œ ëŒ€ì²´í•  ìˆ˜ ìˆë„ë¡ ì„¤ê³„ë˜ì—ˆìŠµë‹ˆë‹¤.

```cs
public record Post(int UserId, int Id, string Title, string Body);

public class PostsService(
    IHttpClientFactory httpClientFactory,
    IMemoryCache memoryCache,
    IDistributedCache distributedCache,
    HybridCache hybridCache)
{
    public async Task<List<Post>?> GetUserPostsAsync(string userId)
    {
        var cacheKey = $"posts_{userId}";

        // ê¸°ì¡´ ë°©ì‹ (Memory Cache)
        var posts = await memoryCache.GetOrCreateAsync(cacheKey,
            async _ => await GetPostsAsync(userId));

        // ê¸°ì¡´ ë°©ì‹ (Distributed Cache)
        var postsJson = await distributedCache.GetStringAsync(cacheKey);
        if (postsJson is null)
        {
            posts = await GetPostsAsync(userId);
            await distributedCache.SetStringAsync(cacheKey, JsonSerializer.Serialize(posts));
        }
        else
        {
            posts = JsonSerializer.Deserialize<List<Post>>(postsJson);
        }

        // .NET 9 (Hybrid Cache)
        posts = await hybridCache.GetOrCreateAsync(cacheKey,
            async _ => await GetPostsAsync(userId), new HybridCacheEntryOptions() {
                Flags = HybridCacheEntryFlags.DisableLocalCache | // ë¶„ì‚° ìºì‹œì²˜ëŸ¼ ë™ì‘
                        HybridCacheEntryFlags.DisableDistributedCache // ë©”ëª¨ë¦¬ ìºì‹œì²˜ëŸ¼ ë™ì‘
            });

        return posts;
    }

    private async Task<List<Post>?> GetPostsAsync(string userId)
    {
        Console.WriteLine("===========Fetching posts from API");
        var url = $"https://jsonplaceholder.typicode.com/posts?userId={userId}";
        var client = httpClientFactory.CreateClient();
        var response = await client.GetAsync(url);
        response.EnsureSuccessStatusCode();
        return await response.Content.ReadFromJsonAsync<List<Post>>();
    }
}
```

- **ë‘ ê°€ì§€ ì¥ì ì˜ ê²°í•© (Best of Both Worlds):** `HybridCache`ëŠ” ë‹¨ì¼ APIë¡œ ë°ì´í„°ë¥¼ ë©”ëª¨ë¦¬ ìºì‹œ(L1) ë˜ëŠ” ë¶„ì‚° ìºì‹œ(L2)ì— ì €ì¥í•  ìˆ˜ ìˆëŠ” ìœ ì—°ì„±ì„ ì œê³µí•©ë‹ˆë‹¤. L1 ìºì‹œëŠ” ìì£¼ ì‚¬ìš©ë˜ëŠ” ë°ì´í„°ë¥¼ ë¹ ë¥´ê²Œ ë¡œì»¬ì—ì„œ ì•¡ì„¸ìŠ¤í•  ìˆ˜ ìˆë„ë¡ í•˜ê³ , L2 ìºì‹œëŠ” ëŒ€ê·œëª¨ ë° ëœ ìì£¼ ì ‘ê·¼ë˜ëŠ” ë°ì´í„°ë¥¼ ì²˜ë¦¬í•  ìˆ˜ ìˆëŠ” í™•ì¥ì„±ì„ ì œê³µí•©ë‹ˆë‹¤. ì´ ë™ì‘ì€ **HybridCacheEntryFlags**ë¡œ ì œì–´í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- **ìŠ¤íƒ¬í”¼ë“œ ë³´í˜¸ (Stampede Protection):** `IMemoryCache`ì™€ `IDistributedCache` ëª¨ë‘ ìŠ¤íƒ¬í”¼ë“œ ë¬¸ì œë¥¼ ê²ªì§€ë§Œ, `HybridCache`ëŠ” ë™ì¼í•œ í‚¤ì— ëŒ€í•´ í•˜ë‚˜ì˜ í˜¸ì¶œë§Œ ê°’ ìƒì„±ì„ ìˆ˜í–‰í•˜ê³ , ë‹¤ë¥¸ í˜¸ì¶œì€ ê²°ê³¼ë¥¼ ëŒ€ê¸°í•˜ë„ë¡ ì²˜ë¦¬í•´ ë¶ˆí•„ìš”í•œ ìºì‹œ ì¬ìƒì„±ì„ ë°©ì§€í•©ë‹ˆë‹¤.
- **ì¶”ê°€ ê¸°ëŠ¥:** `HybridCache`ëŠ” íƒœê¹…(Tagging), `.WithSerializer(...)` ë° `.WithSerializerFactory(...)` ë©”ì„œë“œë¥¼ í†µí•œ ì„¤ì • ê°€ëŠ¥í•œ ì§ë ¬í™”, `[ImmutableObject(true)]` ì–´ë…¸í…Œì´ì…˜ì„ í™œìš©í•œ ìºì‹œ ì¸ìŠ¤í„´ìŠ¤ ì¬ì‚¬ìš©ê³¼ ê°™ì€ ì¶”ê°€ ê¸°ëŠ¥ì„ ì œê³µí•©ë‹ˆë‹¤.

```cs
// ë¶„ì‚° ìºì‹œ (Redis) ì„¤ì •
builder.Services.AddStackExchangeRedisCache(options =>
{
    options.Configuration = "localhost:6379";
    options.InstanceName = "SampleInstance";
});

// ë©”ëª¨ë¦¬ ìºì‹œ ì„¤ì • (ë°ëª¨ ëª©ì )
builder.Services.AddMemoryCache();

// HybridCache ì¶”ê°€
builder.Services.AddHybridCache();
builder.Services.AddSingleton<PostsService>(); // PostsService ë“±ë¡
```

**HybridCache**ëŠ” ë©”ëª¨ë¦¬ ìºì‹œì™€ ë¶„ì‚° ìºì‹œì˜ ì¥ì ì„ ê²°í•©í•˜ì—¬ ë¹ ë¥¸ ì•¡ì„¸ìŠ¤ì™€ í™•ì¥ì„±ì„ ë™ì‹œì— ì œê³µí•©ë‹ˆë‹¤. ìŠ¤íƒ¬í”¼ë“œ ë¬¸ì œë¥¼ í•´ê²°í•˜ë©°, ë‹¤ì–‘í•œ ì„¤ì • ë° ì¶”ê°€ ê¸°ëŠ¥ìœ¼ë¡œ ìœ ì—°í•˜ê³  ê°•ë ¥í•œ ìºì‹± ì†”ë£¨ì…˜ì„ ì œê³µí•©ë‹ˆë‹¤. ğŸš€

## 6. ë‚´ì¥ OpenAPI ë¬¸ì„œ ìƒì„±

.NET 5ë¶€í„° Web API í…œí”Œë¦¿ì€ `Swashbuckle.AspNetCore` íŒ¨í‚¤ì§€ë¥¼ í†µí•´ OpenAPI ì§€ì›ì„ ê¸°ë³¸ìœ¼ë¡œ ì œê³µí•´ì™”ìŠµë‹ˆë‹¤.

.NET 9ì—ì„œëŠ” Microsoftê°€ ìì²´ì ìœ¼ë¡œ ê°œë°œí•œ `Microsoft.AspNetCore.OpenApi` íŒ¨í‚¤ì§€ë¥¼ í†µí•´ OpenAPI ì‚¬ì–‘ì„ ì§€ì›í•˜ë©°, ì´ëŠ” ê¸°ì¡´ì˜ **Swashbuckle.AspNetCore**ë¥¼ ëŒ€ì²´í•©ë‹ˆë‹¤.

```cs
// ê¸°ì¡´ ë°©ì‹ (Before)
builder.Services.AddEndpointsApiExplorer();
builder.Services.AddSwaggerGen();

var app = builder.Build();

if (app.Environment.IsDevelopment())
{
    app.UseSwagger();
    app.UseSwaggerUI();
}
```

.NET 9ì—ì„œëŠ” ë” ê°„ë‹¨í•œ ë°©ì‹ìœ¼ë¡œ OpenAPI ë¬¸ì„œë¥¼ ì„¤ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```cs
// .NET 9 ë°©ì‹
builder.Services.AddOpenApi(); // OpenAPI ì§€ì› ì¶”ê°€
var app = builder.Build();

if (app.Environment.IsDevelopment())
{
    app.MapOpenApi(); // OpenAPI ì—”ë“œí¬ì¸íŠ¸ ë§¤í•‘
}
```

ì•±ì„ ì‹¤í–‰í•œ í›„ **/openapi/v1.json**ìœ¼ë¡œ ì´ë™í•˜ë©´ ìƒì„±ëœ OpenAPI ë¬¸ì„œë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

- **Swagger UI:** ë¬¸ë²•ì´ ë” ì§§ì•„ì§€ê³  ì²˜ìŒ ë³´ê¸°ì— ë” "ë„¤ì´í‹°ë¸Œ"í•˜ê²Œ ë³´ì´ì§€ë§Œ, ê¸°ë³¸ì ìœ¼ë¡œëŠ” ìƒí˜¸ì‘ìš© ê°€ëŠ¥í•œ API ë¬¸ì„œ(Swagger UI)ëŠ” ì œê³µë˜ì§€ ì•Šê³  OpenAPI ë¬¸ì„œë§Œ ìƒì„±ë©ë‹ˆë‹¤. ğŸ˜¢ Swagger UI ê°™ì€ ìƒí˜¸ì‘ìš© ê°€ëŠ¥í•œ API ë¬¸ì„œê°€ í•„ìš”í•˜ë‹¤ë©´ Scalarì™€ ê°™ì€ ì„œë“œíŒŒí‹° ë„êµ¬ë¥¼ í†µí•©í•´ì•¼ í•©ë‹ˆë‹¤. ìì„¸í•œ ê°€ì´ë“œëŠ” Scalar .NET API Reference Integrationì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

- **Build-Time Generation:** `Microsoft.Extensions.ApiDescription.Server` íŒ¨í‚¤ì§€ë¥¼ ì‚¬ìš©í•´ ë¹Œë“œ ì‹œì ì— OpenAPI ë¬¸ì„œë¥¼ ìƒì„±í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.

## 7. SearchValues ê°œì„  ì‚¬í•­

**SearchValues**ëŠ” .NET 8ì—ì„œ ë„ì…ëœ ë¶ˆë³€(immutable) ë° ì½ê¸° ì „ìš© ê°’ ì§‘í•©ìœ¼ë¡œ, ê¸°ì¡´ì˜ **ICollection.Contains**ë³´ë‹¤ í›¨ì”¬ ë” íš¨ìœ¨ì ì¸ ê²€ìƒ‰ì„ ì œê³µí•©ë‹ˆë‹¤. ì²˜ìŒì—ëŠ” ë¬¸ì(char)ë‚˜ ë°”ì´íŠ¸(byte) ì§‘í•©ë§Œ ì§€ì›í–ˆì§€ë§Œ, .NET 9ì—ì„œëŠ” ë¬¸ìì—´(string)ë„ ì§€ì›í•˜ë„ë¡ í™•ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.

```cs
var text = "Exploring new capabilities of SearchValues!".AsSpan();

// ê¸°ì¡´ ë°©ì‹
var vowelSearch = SearchValues.Create([ 'n', 'e', 'w' ]); // ë¬¸ì ì§‘í•© ê²€ìƒ‰
Console.WriteLine(text.ContainsAny(vowelSearch));

// .NET 9 ë°©ì‹
var keywordSearch = SearchValues.Create(["new", "of"], StringComparison.OrdinalIgnoreCase); // ë¬¸ìì—´ ê²€ìƒ‰
Console.WriteLine(text.ContainsAny(keywordSearch));
```

.NET 9ì—ì„œëŠ” `StringComparison` ë§¤ê°œë³€ìˆ˜ë¥¼ ì‚¬ìš©í•´ ë¹„êµ ë°©ì‹ì„ ì§€ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì´ì œ ë¬¸ìì—´ë„ ì§€ì›í•˜ë©°, ëŒ€ì†Œë¬¸ì ë¬´ì‹œ ë“±ì˜ ë¹„êµ ì˜µì…˜ì„ ì§€ì •í•  ìˆ˜ ìˆëŠ” ê¸°ëŠ¥ì´ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤. ì•ìœ¼ë¡œ ì´ ê¸°ëŠ¥ì€ ë¬¸ì„œ íŒŒì‹±, ì…ë ¥ í•„í„°ë§, ìŠ¤íŒ¸ ê°ì§€, ë°ì´í„° í¸ì§‘, ê²€ìƒ‰ ë“± ê´‘ë²”ìœ„í•œ í…ìŠ¤íŠ¸ ì²˜ë¦¬ ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ í•„ìˆ˜ì ì¸ ë„êµ¬ê°€ ë  ê²ƒì…ë‹ˆë‹¤. ğŸš€

## 8. ìƒˆë¡œìš´ LINQ ë©”ì„œë“œ

.NET 9ì—ì„œëŠ” `CountBy`, `AggregateBy`, `Index`ë¼ëŠ” ì„¸ ê°€ì§€ ìƒˆë¡œìš´ LINQ ë©”ì„œë“œê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤. ì´ ë©”ì„œë“œë“¤ì€ ì¼ë°˜ì ì¸ ë°ì´í„° ì¡°ì‘ ì‘ì—…ì—ì„œ ì„±ëŠ¥ê³¼ ê°„ê²°ì„±ì„ í–¥ìƒì‹œí‚¤ë„ë¡ ì„¤ê³„ë˜ì—ˆìŠµë‹ˆë‹¤. ì•„ë˜ëŠ” ê° ë©”ì„œë“œì˜ ì˜ˆì‹œì™€ ì„¤ëª…ì…ë‹ˆë‹¤.

### `CountBy`

íŠ¹ì • í‚¤ë¡œ ê·¸ë£¹í™”í•˜ê³  ê° ê·¸ë£¹ì˜ í•­ëª© ìˆ˜ë¥¼ ê³„ì‚°í•©ë‹ˆë‹¤.

```cs
(string firstName, string lastName)[] people =
[
   ("John", "Doe"),
   ("Jane", "Peterson"),
   ("John", "Smith"),
   ("Mary", "Johnson"),
   ("Nick", "Carson"),
   ("Mary", "Morgan")
];

// ê¸°ì¡´ ë°©ì‹
var firstNameCounts = people
   .GroupBy(p => p.firstName)
   .ToDictionary(group => group.Key, group => group.Count())
   .AsEnumerable();

// .NET 9 ë°©ì‹
firstNameCounts = people
   .CountBy(p => p.firstName);

foreach(var entry in firstNameCounts)
{
   Console.WriteLine($"First Name {entry.Key} appears {entry.Value} times");
}

/*
ì¶œë ¥:
First Name John appears 2 times
First Name Jane appears 1 times
First Name Mary appears 2 times
First Name Nick appears 1 times
*/
```

### `AggregateBy`

ê·¸ë£¹í™”ëœ ë°ì´í„°ì—ì„œ ê°’ë“¤ì„ ì§‘ê³„í•©ë‹ˆë‹¤.

```cs
(string name, string department, int vacationDaysLeft)[] employees =
[
   ("John Doe", "IT", 12),
   ("Jane Peterson", "Marketing", 18),
   ("John Smith", "IT", 28),
   ("Mary Johnson", "HR", 17),
   ("Nick Carson", "Marketing", 5),
   ("Mary Morgan", "HR", 9)
];

// ê¸°ì¡´ ë°©ì‹
var departmentVacationDaysLeft = employees
   .GroupBy(emp => emp.department)
   .ToDictionary(group => group.Key, group => group.Sum(emp => emp.vacationDaysLeft))
   .AsEnumerable();

// .NET 9 ë°©ì‹
departmentVacationDaysLeft = employees
   .AggregateBy(emp => emp.department, 0, (acc, emp) => acc + emp.vacationDaysLeft);

foreach (var entry in departmentVacationDaysLeft)
   Console.WriteLine($"Department {entry.Key} has a total of {entry.Value} vacation days left.");

/*
ì¶œë ¥:
Department IT has a total of 40 vacation days left.
Department Marketing has a total of 23 vacation days left.
Department HR has a total of 26 vacation days left.
*/
```

### `Index`

ì»¬ë ‰ì…˜ì˜ ê° í•­ëª©ì— ì¸ë±ìŠ¤ë¥¼ ë§¤í•‘í•©ë‹ˆë‹¤.

```cs
var managers = new[]
{
   "John Doe",
   "Jane Peterson",
   "John Smith"
};

// ê¸°ì¡´ ë°©ì‹
foreach (var (index, manager) in managers.Select((m, i) => (i, m)))
   Console.WriteLine($"Manager {index}: {manager}");

// .NET 9 ë°©ì‹
foreach (var (index, manager) in managers.Index())
   Console.WriteLine($"Manager {index}: {manager}");

/*
ì¶œë ¥:
Manager 0: John Doe
Manager 1: Jane Peterson
Manager 2: John Smith
*/
```

ê°€ì¥ ì¢‹ì€ í•¨ìˆ˜ëŠ” `Index()`ì…ë‹ˆë‹¤. foreachì—ì„œ ì¸ë±ìŠ¤ê°€ ì—†ëŠ” ì ì€ í•­ìƒ ê³¨ì¹«ê±°ë¦¬ì˜€ê³ , ì¢…ì¢… ë” ë³µì¡í•œ ìš°íšŒ ë°©ë²•ì„ ì‚¬ìš©í•˜ê²Œ ë§Œë“¤ì—ˆê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.

## 9. ë‚´ì¥ UUID v7 ìƒì„±

.NET ì´ˆê¸°ë¶€í„° `Guid.NewGuid()`ë¥¼ ì‚¬ìš©í•´ UUIDë¥¼ ìƒì„±í•´ì™”ìŠµë‹ˆë‹¤. ì´ ë°©ì‹ì€ **UUID v4**ë¥¼ ìƒì„±í•©ë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ UUID ì‚¬ì–‘ì€ ì§€ì†ì ìœ¼ë¡œ ë°œì „í•´ í˜„ì¬ì˜ ì•ˆì •ëœ ë²„ì „ì€ **UUID v7**ì…ë‹ˆë‹¤.

**UUID v7**ì˜ ì£¼ìš” íŠ¹ì§• ì¤‘ í•˜ë‚˜ëŠ” UUIDì— í¬í•¨ëœ **íƒ€ì„ìŠ¤íƒ¬í”„**(timestamp)ì…ë‹ˆë‹¤. êµ¬ì¡°ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:

```arduino
+------------------+---------------+----------------------+
| 48-bit timestamp | 12-bit random |    62-bit random     |
+------------------+---------------+----------------------+
```

ì´ íƒ€ì„ìŠ¤íƒ¬í”„ ë•ë¶„ì— UUIDë¥¼ ìƒì„± ì‹œê°„ì— ë”°ë¼ ì •ë ¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ëŠ” ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ë”ìš± ì í•©í•˜ë©°, ë¶„ì‚° í™˜ê²½ì—ì„œ ë” ë‚˜ì€ ê³ ìœ ì„±ì„ ë³´ì¥í•©ë‹ˆë‹¤.

ì´ì œ .NETì—ì„œëŠ” ì™¸ë¶€ ë¼ì´ë¸ŒëŸ¬ë¦¬(ì˜ˆ: `UUIDNext`)ë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šê³ ë„ UUID v7ì„ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ìƒˆë¡œìš´ `Guid.CreateVersion7()` ë©”ì„œë“œê°€ ì´ë¥¼ ì§€ì›í•˜ë©°, íŠ¹ì • íƒ€ì„ìŠ¤íƒ¬í”„ë¥¼ ë°›ì•„ UUIDë¥¼ ìƒì„±í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤. ì´ëŠ” í…ŒìŠ¤íŠ¸ ëª©ì ì´ë‚˜ ì •ë ¬ëœ ì‹œí€€ìŠ¤ì— íŠ¹ì • ìœ„ì¹˜ì— í•­ëª©ì„ ì‚½ì…í•  ë•Œ ìœ ìš©í•©ë‹ˆë‹¤.

```cs
var guid = Guid.NewGuid(); // v4 UUID
guid = Guid.CreateVersion7(); // v7 UUID ìƒì„±
guid = Guid.CreateVersion7(TimeProvider.System.GetUtcNow()); // íƒ€ì„ìŠ¤íƒ¬í”„ê°€ í¬í•¨ëœ v7 UUID ìƒì„±
```

- `Guid.CreateVersion7()`ëŠ” ë‚´ë¶€ì ìœ¼ë¡œ `NewGuid()`ë¥¼ ì‚¬ìš©í•˜ë©°, 48ë¹„íŠ¸ íƒ€ì„ìŠ¤íƒ¬í”„ë¥¼ ì¶”ê°€í•˜ê³  UUID v7 í‘œì¤€ì— ë§ê²Œ ì˜¬ë°”ë¥¸ ë²„ì „ ë° ë³€í˜• ë¹„íŠ¸ë¥¼ ì„¤ì •í•©ë‹ˆë‹¤.
- ì´ë¡œ ì¸í•´ `NewGuid()`ë³´ë‹¤ ì•½ê°„ ëŠë¦´ ìˆ˜ ìˆì§€ë§Œ, ìˆ˜ë°±ë§Œ ê°œì˜ UUIDë¥¼ ìƒì„±í•´ì•¼ í•˜ëŠ” ê²½ìš°ê°€ ì•„ë‹ˆë¼ë©´ ì„±ëŠ¥ ì°¨ì´ëŠ” ê±°ì˜ ëŠê»´ì§€ì§€ ì•ŠìŠµë‹ˆë‹¤.

## 10. ê¸°íƒ€ ê¸°ëŠ¥

ì•„ë˜ëŠ” í¥ë¯¸ë¡œìš´ ë³€ê²½ ì‚¬í•­ë“¤ì˜ ëª©ë¡ìœ¼ë¡œ, íŠ¹ì •í•œ ì‚¬ìš© ì‚¬ë¡€ì— ì í•©í•˜ë©° ë„ë¦¬ ì±„íƒë˜ê¸°ë³´ë‹¤ëŠ” íŠ¹ì • ìƒí™©ì—ì„œ ìœ ìš©í•˜ê²Œ ì‚¬ìš©ë  ìˆ˜ ìˆëŠ” ê¸°ëŠ¥ë“¤ì…ë‹ˆë‹¤.

- [ì•”ì‹œì  ì¸ë±ìŠ¤ ì ‘ê·¼(Implicit index access)](https://learn.microsoft.com/en-us/dotnet/csharp/whats-new/csharp-13#implicit-index-access)
- [ë¶€ë¶„ ì†ì„±(Partial properties)](https://github.com/dotnet/core/blob/2f5ecee9ea988b4d85e288178c9d16131f3b0c43/release-notes/9.0/preview/preview6/csharp.md#partial-properties)
- [ref struct í—ˆìš©](https://github.com/dotnet/core/blob/main/release-notes/9.0/preview/preview6/libraries.md#allows-ref-struct-used-in-many-places-throughout-the-libraries)
- [Base64Url ì§€ì›](https://learn.microsoft.com/en-us/dotnet/core/whats-new/dotnet-9/libraries#base64url)
- [Spanì„ ì‚¬ìš©í•œ ì»¬ë ‰ì…˜ ì¡°íšŒ](https://github.com/dotnet/core/blob/2f5ecee9ea988b4d85e288178c9d16131f3b0c43/release-notes/9.0/preview/preview6/libraries.md#collection-lookups-with-spans)
- [Regex.EnumerateSplits](https://github.com/dotnet/core/blob/2f5ecee9ea988b4d85e288178c9d16131f3b0c43/release-notes/9.0/preview/preview6/libraries.md#regexenumeratesplits)
- [System.Text.Jsonì˜ ìƒˆë¡œìš´ ê¸°ëŠ¥](https://github.com/dotnet/core/blob/2f5ecee9ea988b4d85e288178c9d16131f3b0c43/release-notes/9.0/preview/preview6/libraries.md#systemtextjson)
- [`OrderedDictionary<TKey, TValue>`](https://github.com/dotnet/core/blob/2f5ecee9ea988b4d85e288178c9d16131f3b0c43/release-notes/9.0/preview/preview6/libraries.md#ordereddictionarytkey-tvalue)
- [`ReadOnlySet<T>`](https://github.com/dotnet/core/blob/d6826c747b07bb4f050e2692bc309b8acd6ec1ec/release-notes/9.0/preview/preview6/libraries.md#readonlysett)
- [New `Tensor<T>` íƒ€ì…](https://github.com/dotnet/core/blob/main/release-notes/9.0/preview/preview4/libraries.md#new-tensort-type)
