---
title: '[TensorFlow 2.0] 각 Layer별 역할 및 파라미터'
categories:
  - Programming
  - AI
tags:
  - AI
  - Tensorflow
date: 2020-07-20 16:39:18
thumbnail:
---

## Layer Explaination

### Load Packages

```python
import tensorflow as tf
import os

import matplotlib.pyplot as plt
%matplotlib inline
```

### Input Image

```python
from tensorflow.keras import datasets

(train_x, train_y), (test_x, test_y) = datasets.mnist.load_data()
image = train_x[0]

# 차원 수 높이기
image = image[tf.newaxis, ..., tf.newaxis]
image.shape

# Out
(1, 28, 28, 1)
```

## Feature Extraction

![](/images/ai/dev/4.png)

### Convolution

![](/images/ai/dev/5.png)

- filters: layer에서 나갈 때 몇 개의 filter를 만들 것인지
- kernel_size: filter(Weight)의 크기
- strides: 몇 개의 pixel을 skip 하면서 훑어지나갈 것인지 (크기에도 영향을 준다)
- padding: zero padding을 만들 것인지. VALID는 padding이 없고, SAME은 padding이 있다. (크기에도 영향을 준다)
- activation: Activation Function을 만들 것인지. 당장 설정 안해도 Layer 층을 따로 만들 수 있다. (Default: None)

```python
tf.keras.layers.Conv2D(filters=3, kernel_size=(3, 3), strides=(1, 1), padding='SAME', activation='relu')

# (3, 3) 대신에 3으로도 대체 가능
tf.keras.layers.Conv2D(3, 3, 1, 'SAME')
```

### Visualization

```python
image = tf.cast(image, dtype=tf.float32)

layer = tf.keras.layers.Conv2D(3, 3, strides=(1, 1), padding='SAME')
output = layer(image)
```

```python
plt.subplot(121)
plt.imshow(image[0, :, :, 0], 'gray')
plt.subplot(122)
plt.imshow(output[0, :, :, 0], 'gray')
plt.show()
```

![](/images/ai/dev/6.png)

weight 불러오기

```python
weight = layer.get_weights()[0]

plt.figure(figsize=(15, 5))
plt.subplot(131)
plt.hist(output.numpy().ravel(), range=[-2, 2])
plt.ylim(0, 100)
plt.subplot(132)
plt.title(weight.shape)
plt.imshow(weight[:, :, 0, 0], 'gray')
plt.subplot(133)
plt.title(output.shape)
plt.imshow(output[0, :, :, 0], 'gray')
plt.colorbar()
plt.show()
```

![](/images/ai/dev/7.png)

### Activation Function

0 미만의 값들을 0으로 바꿔준다.
![](/images/ai/dev/8.png)

```python
act_layer = tf.keras.layers.ReLU()
act_output = act_layer(output)


```
